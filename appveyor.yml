os: Visual Studio 2015

platform:
  - Win32
  - Win64

configuration:
  - Debug

before_build:
  - if %platform%==Win32 set generator=Visual Studio 14
  - if %platform%==Win64 set generator=Visual Studio 14 Win64
  - if %platform%==Win32 set vcplatform=Win32
  - if %platform%==Win64 set vcplatform=x64
  - set cwd=%cd%
  - ps: Start-FileDownload 'https://github.com/egorpugin/leptonica/archive/master.zip' -FileName leptonica.zip
  - 7z x leptonica.zip
  - cmake -Hleptonica-master -Bleptonica-master/build -G "%generator%" -DSTATIC=1
  - msbuild leptonica-master/build/leptonica.sln /p:Platform=%vcplatform% /logger:"C:\Program Files\AppVeyor\BuildAgent\Appveyor.MSBuildLogger.dll"
  - ps: Start-FileDownload 'https://github.com/tesseract-ocr/tesseract/archive/master.zip' -FileName tesseract.zip
  - 7z x tesseract.zip
  - cmake -Htesseract-master -Btesseract-master/build -G "%generator%" -DLeptonica_BUILD_DIR=%cwd%\leptonica-master\build -DSTATIC=1
  - msbuild tesseract-master/build/tesseract.sln /p:Platform=%vcplatform% /logger:"C:\Program Files\AppVeyor\BuildAgent\Appveyor.MSBuildLogger.dll"
  - git submodule update

build_script:
  - mkdir build
  - cmake %cwd% -B%cwd%\build -G "%generator%" -DADD_INCLUDE_DIR=%cwd%\tesseract-master\ccutil -DLeptonica_BUILD_DIR=%cwd%\leptonica-master\build -DTesseract_BUILD_DIR=%cwd%\tesseract-master\build -DSTATIC=1
  - msbuild %cwd%\build\recognizer.sln /p:Platform=%vcplatform% /logger:"C:\Program Files\AppVeyor\BuildAgent\Appveyor.MSBuildLogger.dll"
